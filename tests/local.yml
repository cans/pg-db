---
- name: Bring up docker containers
  hosts: localhost
  gather_facts: false
  vars:
    inventory:
      - name: ansibletesting_base_1
        image: "ncaniart/ansible-testing-pgclient:20180722"
        # image: "ncaniart/ansible-testing-base:20180617150839"  # 
        # command: "/bin/sh -c 'while true ; do sleep 10 ; done'"
        groups:
          - servers
        env:
          PGHOST: "pgdb_postgresql_1"
          POSTGRES_DB: "postgres"
          POSTGRES_PASSWORD: "theadminpassword"
          POSTGRES_USER: "postgres"
      - name: pgdb_postgresql_1
        image: "postgres:9.6.2-alpine"
        groups:
          - "not-servers"
        env:  # Content duplicated see how to use `env_file`.
          POSTGRES_DB: "postgres"
          POSTGRES_PASSWORD: "theadminpassword"
          POSTGRES_USER: "postgres"

  roles:
    - role: chrismeyersfsu.provision_docker
      provision_docker_inventory: "{{inventory}}"
      provision_docker_use_docker_connection: true


- name: "Override Python PATH"
  hosts: servers
  gather_facts: false
  tasks:
    - name: Set Python Interpreter
      set_fact:
        ansible_python_interpreter: /usr/bin/python2.7
        ansible_connection: docker


- import_playbook: ./test.yml

# vim: et:sw=2:syntax=yaml:ts=2:
